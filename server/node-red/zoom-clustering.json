[{"type":"tab","id":"2802de5e.d7fd22","label":"Zoom levels"},{"type":"tab","id":"f0a3c2ce.0f5c4","label":"Twitter Hashtag clustering"},{"type":"tab","id":"682ad7db.97d528","label":"ETL"},{"type":"tab","id":"164edfb5.5e939","label":"Dev"},{"type":"tab","id":"6b10de81.8bb45","label":"Scrapes"},{"id":"ce4a5be1.31b5a8","type":"inject","z":"2802de5e.d7fd22","name":"Get Events For Clusterer Input","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"x":192,"y":186.24999809265137,"wires":[["2c8da7b2.d37258"]]},{"id":"eacdbcb9.15324","type":"http request","z":"2802de5e.d7fd22","name":"","method":"use","ret":"txt","url":"","x":140,"y":356.24999809265137,"wires":[["a3d2bcea.5c2d4","14eab7cf.eb1548"]]},{"id":"2c8da7b2.d37258","type":"function","z":"2802de5e.d7fd22","name":"Get Events","func":"msg.method = 'POST';\nmsg.url = 'http://localhost:' + context.global.port + '/ZoomLevelEventClusterer/getEventsForClustererInput';\nmsg.payload = {\n    modelNames: ['HashtagEventsSource','SandboxEventsSource'],\n    endDate: '2015-08-19T09:40:00.000Z',\n    intervalDurationMinutes: 2,\n    intervalsAgo: 1\n};\nreturn msg;","outputs":1,"noerr":0,"x":140,"y":281.24999809265137,"wires":[["eacdbcb9.15324"]]},{"id":"14eab7cf.eb1548","type":"function","z":"2802de5e.d7fd22","name":"Cluster Events","func":"msg.method = 'POST';\nmsg.url = 'http://localhost:' + context.global.port + '/ZoomLevelEventClusterer/clusterEvents';\nmsg.payload = JSON.parse(msg.payload);\nmsg.payload.zoomLevel = 3;\nmsg.payload.clusterCount = 2;\nreturn msg;","outputs":1,"noerr":0,"x":145,"y":439.24999809265137,"wires":[["677d5386.9882ac"]]},{"id":"1121266.feededa","type":"debug","z":"2802de5e.d7fd22","name":"","active":true,"console":"false","complete":"payload","x":472,"y":517.2499980926514,"wires":[]},{"id":"677d5386.9882ac","type":"http request","z":"2802de5e.d7fd22","name":"","method":"use","ret":"txt","url":"","x":141,"y":519.2499980926514,"wires":[["1121266.feededa","df4a987f.20b568"]]},{"id":"a3d2bcea.5c2d4","type":"debug","z":"2802de5e.d7fd22","name":"","active":true,"console":"false","complete":"payload","x":477,"y":353.24999809265137,"wires":[]},{"id":"df4a987f.20b568","type":"function","z":"2802de5e.d7fd22","name":"Update Zoom Level","func":"msg.method = 'POST';\nmsg.url = 'http://localhost:' + context.global.port + '/ZoomLevelEventClusterer/updateZoomLevel';\nmsg.payload = JSON.parse(msg.payload);\n//msg.payload.zoomLevel = 3;\n//msg.payload.clusterCount = 2;\nreturn msg;","outputs":1,"noerr":0,"x":142,"y":614.2499980926514,"wires":[["5add66a8.a52298"]]},{"id":"5add66a8.a52298","type":"http request","z":"2802de5e.d7fd22","name":"","method":"use","ret":"txt","url":"","x":128,"y":703.2499980926514,"wires":[["b664f0ee.499b1"]]},{"id":"b664f0ee.499b1","type":"debug","z":"2802de5e.d7fd22","name":"","active":true,"console":"true","complete":"payload","x":497,"y":700.2499980926514,"wires":[]},{"id":"73fc27a3.8c03d8","type":"inject","z":"2802de5e.d7fd22","name":"Create Zoom Levels","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"x":156.3332977294922,"y":65.33333587646484,"wires":[["82776fb.f7d889"]]},{"id":"a72f33c1.58d0d","type":"http request","z":"2802de5e.d7fd22","name":"","method":"use","ret":"txt","url":"","x":717.3332977294922,"y":65.33333587646484,"wires":[["fe7f48d7.0180b8"]]},{"id":"fe7f48d7.0180b8","type":"debug","z":"2802de5e.d7fd22","name":"","active":true,"console":"false","complete":"false","x":924.3332977294922,"y":66.33333587646484,"wires":[]},{"id":"82776fb.f7d889","type":"function","z":"2802de5e.d7fd22","name":"Create Zoom Levels","func":"msg.method = 'POST';\nmsg.url = context.global.host + '/ZoomLevelEventClusterer/createZoomLevels';\nmsg.payload = {\n    modelNames: ['HashtagEventsSource'],\n    endDate: '2015-06-22T00:00:00.000Z',\n    intervalDurationMinutes: 1440,\n    totalIntervals: 2,\n    zoomLevelClusterCounts:[20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20]\n    //zoomLevelClusterCounts:[4,8,12,16,20]\n};\nreturn msg;","outputs":1,"noerr":0,"x":438.3332977294922,"y":65.33333587646484,"wires":[["a72f33c1.58d0d"]]},{"id":"10747388.ef8b8c","type":"inject","z":"f0a3c2ce.0f5c4","name":"Start Twitter Scrape","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"x":192.1999969482422,"y":80,"wires":[["bc1ed5ae.43e128"]]},{"id":"8d5317e.f72ace8","type":"http request","z":"f0a3c2ce.0f5c4","name":"","method":"use","ret":"txt","url":"","x":847.1999969482422,"y":80,"wires":[["16daa0cc.e9255f"]]},{"id":"16daa0cc.e9255f","type":"debug","z":"f0a3c2ce.0f5c4","name":"","active":true,"console":"false","complete":"false","x":1131.1999969482422,"y":81,"wires":[]},{"id":"bc1ed5ae.43e128","type":"function","z":"f0a3c2ce.0f5c4","name":"POST Buffer Prep","func":"msg.method = 'POST';\nmsg.url = 'http://localhost:' + context.global.port + '/TwitterHashtagClusterer/startTwitterScrape';\nmsg.payload = {\n    onlyWithHashtags: true,\n    onlyWithLocation: true,\n    maxPlaceSizeMeters: 100,\n    boundingBox:{\n        latSouth: 30.25,\n        latNorth: 30.30,\n        lngWest: -97.77,\n        lngEast: -97.73\n    }\n};\nreturn msg;","outputs":1,"noerr":0,"x":508.1999969482422,"y":80,"wires":[["8d5317e.f72ace8"]]},{"id":"a40010c4.5bfff","type":"inject","z":"f0a3c2ce.0f5c4","name":"Load Tweets from JSON files","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"x":179.1999969482422,"y":211,"wires":[["410fe553.bef01c"]]},{"id":"bfbc84ce.404378","type":"http request","z":"f0a3c2ce.0f5c4","name":"","method":"use","ret":"txt","url":"","x":834.1999969482422,"y":211,"wires":[["4f18b653.b0e748"]]},{"id":"4f18b653.b0e748","type":"debug","z":"f0a3c2ce.0f5c4","name":"","active":true,"console":"false","complete":"false","x":1118.1999969482422,"y":212,"wires":[]},{"id":"410fe553.bef01c","type":"function","z":"f0a3c2ce.0f5c4","name":"POST Prep","func":"msg.method = 'POST';\nmsg.url = 'http://localhost:' + context.global.port + '/TwitterHashtagClusterer/loadTestTweetFiles';\nmsg.payload = {\n    foldersToSearch: '/home/jreeme/src/hashTagClustering/raw_tweet_data/real-json',\n    globExpression: '*12-12*.json'\n};\nreturn msg;","outputs":1,"noerr":0,"x":495.1999969482422,"y":211,"wires":[["bfbc84ce.404378"]]},{"id":"d03985fa.2fc678","type":"inject","z":"f0a3c2ce.0f5c4","name":"Test ReST Translate File","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"x":165.1999969482422,"y":144,"wires":[["51db6579.ae249c"]]},{"id":"d1ffd2d9.2e003","type":"http request","z":"f0a3c2ce.0f5c4","name":"","method":"use","ret":"txt","url":"","x":820.1999969482422,"y":144,"wires":[["cedb329a.3124d"]]},{"id":"cedb329a.3124d","type":"debug","z":"f0a3c2ce.0f5c4","name":"","active":true,"console":"false","complete":"false","x":1104.1999969482422,"y":145,"wires":[]},{"id":"51db6579.ae249c","type":"function","z":"f0a3c2ce.0f5c4","name":"POST Prep","func":"msg.method = 'POST';\nmsg.url = 'http://localhost:' + context.global.port + '/TwitterHashtagClusterer/translateFileToGeoTweet';\nmsg.payload = {\n    path: '/home/jreeme/src/hashTagClustering/raw_tweet_data/real-json/2015-12-12_23:22:03.137328.real.json'\n};\nreturn msg;","outputs":1,"noerr":0,"x":481.1999969482422,"y":144,"wires":[["d1ffd2d9.2e003"]]},{"id":"cc9992b7.33667","type":"inject","z":"f0a3c2ce.0f5c4","name":"Index GeoTweets by Hashtag","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"x":204.1999969482422,"y":343,"wires":[["63380541.9cc7fc"]]},{"id":"67dea1dc.98216","type":"http request","z":"f0a3c2ce.0f5c4","name":"","method":"use","ret":"txt","url":"","x":859.1999969482422,"y":343,"wires":[["44e02780.bb1fd8"]]},{"id":"44e02780.bb1fd8","type":"debug","z":"f0a3c2ce.0f5c4","name":"","active":true,"console":"false","complete":"false","x":1143.1999969482422,"y":344,"wires":[]},{"id":"63380541.9cc7fc","type":"function","z":"f0a3c2ce.0f5c4","name":"POST Prep","func":"msg.method = 'POST';\nmsg.url = context.global.host + '/TwitterHashtagClusterer/indexGeoTweetsByHashtag';\nmsg.payload = {\n    limit: 400\n};\nreturn msg;","outputs":1,"noerr":0,"x":520.1999969482422,"y":343,"wires":[["67dea1dc.98216"]]},{"id":"b3676843.4c9898","type":"inject","z":"f0a3c2ce.0f5c4","name":"Cluster Hashtags","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"x":187.1999969482422,"y":436,"wires":[["c28f22c2.3d70e"]]},{"id":"bb8df2fb.44721","type":"http request","z":"f0a3c2ce.0f5c4","name":"","method":"use","ret":"txt","url":"","x":842.1999969482422,"y":436,"wires":[["c78cd332.38733"]]},{"id":"c78cd332.38733","type":"debug","z":"f0a3c2ce.0f5c4","name":"","active":true,"console":"false","complete":"false","x":1126.1999969482422,"y":437,"wires":[]},{"id":"c28f22c2.3d70e","type":"function","z":"f0a3c2ce.0f5c4","name":"POST Prep","func":"msg.method = 'POST';\nmsg.url = context.global.host + '/TwitterHashtagClusterer/clusterHashtags';\nmsg.payload = {\n    minTweetCount: 2,\n    minUniqueUsers: 1,\n    dbscanTimeEpsilonMinutes: 1440,\n    dbscanTimeMinMembersInCluster: 2,\n    dbscanGeoEpsilonMeters: 10000,\n    dbscanGeoMinMembersInCluster: 2\n};\nreturn msg;","outputs":1,"noerr":0,"x":503.1999969482422,"y":436,"wires":[["bb8df2fb.44721"]]},{"id":"3998c38d.c6673c","type":"inject","z":"682ad7db.97d528","name":"Start ETL","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"x":169.0994415283203,"y":149.09091186523438,"wires":[["e661b02c.199e5"]]},{"id":"e661b02c.199e5","type":"function","z":"682ad7db.97d528","name":"ETL EntityExtract","func":"msg.method = 'POST';\nmsg.url = 'http://localhost:' + context.global.port + '/ETL/entityExtract';\nmsg.payload = {};\nreturn msg;","outputs":1,"noerr":0,"x":423.0994110107422,"y":149.09091186523438,"wires":[["386ed470.c7912c"]]},{"id":"76bd848b.89427c","type":"debug","z":"682ad7db.97d528","name":"","active":true,"console":"false","complete":"payload","x":915.0994110107422,"y":148.09091186523438,"wires":[]},{"id":"386ed470.c7912c","type":"http request","z":"682ad7db.97d528","name":"","method":"use","ret":"txt","url":"","x":687.0994110107422,"y":150.09091186523438,"wires":[["76bd848b.89427c"]]},{"id":"4046f9e5.03e608","type":"inject","z":"164edfb5.5e939","name":"Generate Development Data","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"x":175.66604614257812,"y":71.21212005615234,"wires":[["b0aa6321.e073e"]]},{"id":"8cd9c7f6.6a5538","type":"http request","z":"164edfb5.5e939","name":"","method":"use","ret":"txt","url":"","x":736.6660461425781,"y":71.21212005615234,"wires":[["3ecd666a.cd191a"]]},{"id":"3ecd666a.cd191a","type":"debug","z":"164edfb5.5e939","name":"","active":true,"console":"false","complete":"false","x":943.6660461425781,"y":72.21212005615234,"wires":[]},{"id":"b0aa6321.e073e","type":"function","z":"164edfb5.5e939","name":"Generate Development Data","func":"msg.method = 'POST';\nmsg.url = context.global.host + '/ZoomLevelEventClusterer/generateDevelopmentData';\nmsg.payload = {\n    randomGeneratorSeed: 0xfecefece,\n    minPostDate: '2015-08-19T09:20:00.000Z',\n    maxPostDate: '2015-08-19T09:45:00.000Z',\n    eventCountMin: 100,\n    eventCountMax: 200,\n    modelNames: ['HashtagEventsSource','SandboxEventsSource'],\n    eventSources: ['hashtag','instagram'],\n    //\n\n    endDate: '2015-08-19T09:40:00.000Z',\n    intervalDurationMinutes: 2,\n    totalIntervals: 5,\n    //\n    zoomLevelClusterCounts:[4,8,12,16,20]\n};\nreturn msg;","outputs":1,"noerr":0,"x":457.6660461425781,"y":71.21212005615234,"wires":[["8cd9c7f6.6a5538"]]},{"id":"bc028289.9cb13","type":"inject","z":"164edfb5.5e939","name":"Create Fake Events","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"x":140.11048889160156,"y":155.65655517578125,"wires":[["7f9dd68c.81b988"]]},{"id":"db03681f.567188","type":"http request","z":"164edfb5.5e939","name":"","method":"use","ret":"txt","url":"","x":701.1104888916016,"y":155.65655517578125,"wires":[["69a61704.3df8d8"]]},{"id":"69a61704.3df8d8","type":"debug","z":"164edfb5.5e939","name":"","active":true,"console":"false","complete":"payload","x":908.1104888916016,"y":156.65655517578125,"wires":[]},{"id":"7f9dd68c.81b988","type":"function","z":"164edfb5.5e939","name":"Create Fake Events","func":"msg.method = 'POST';\nmsg.url = context.global.host + '/ZoomLevelEventClusterer/createFakeEvents';\nmsg.payload = {\n    randomGeneratorSeed: 0xfecefece,\n    modelNames: ['HashtagEventsSource','SandboxEventsSource'],\n    sandboxEventSourceFile: '../../import/sandbox/exampleSandboxEventSource.json',\n    eventSources: ['hashtag','instagram'],\n    minPostDate: '2015-08-19T09:30:00.000Z',\n    maxPostDate: '2015-08-19T09:45:00.000Z',\n    eventCountMin: 100,\n    eventCountMax: 200\n};\nreturn msg;","outputs":1,"noerr":0,"x":422.11048889160156,"y":155.65655517578125,"wires":[["db03681f.567188"]]},{"id":"217d7f82.5c049","type":"inject","z":"2802de5e.d7fd22","name":"","topic":"Time Series Chart","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"x":156.0994415283203,"y":123.09091186523438,"wires":[["4ef263ad.6034dc"]]},{"id":"4ef263ad.6034dc","type":"function","z":"2802de5e.d7fd22","name":"Build Time Series Chart","func":"msg.method = 'POST';\nmsg.url = context.global.host + '/ZoomLevelEventClusterer/buildTimeSeriesChart';\nmsg.payload = {};\nreturn msg;","outputs":1,"noerr":0,"x":442.0994415283203,"y":124.09091186523438,"wires":[["ebf408d4.ab1278"]]},{"id":"ebf408d4.ab1278","type":"http request","z":"2802de5e.d7fd22","name":"","method":"use","ret":"txt","url":"","x":714.0994110107422,"y":125.09091186523438,"wires":[["97d517b4.5d5828"]]},{"id":"97d517b4.5d5828","type":"debug","z":"2802de5e.d7fd22","name":"","active":true,"console":"false","complete":"false","x":930.0994110107422,"y":125.09091186523438,"wires":[]},{"id":"45a18453.55aacc","type":"inject","z":"164edfb5.5e939","name":"","topic":"Prep Hashtag Cluster","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"x":149.0994415283203,"y":243.09091186523438,"wires":[["a54aca99.70bb78"]]},{"id":"a54aca99.70bb78","type":"function","z":"164edfb5.5e939","name":"Prep Hashtag Cluster","func":"msg.method = 'POST';\nmsg.url = context.global.host + '/dev/prepHashtagCluster';\nmsg.payload = {\n    \n};\nreturn msg;","outputs":"1","noerr":0,"x":421.0994110107422,"y":242.09091186523438,"wires":[["13a0b86a.a18548"]]},{"id":"13a0b86a.a18548","type":"http request","z":"164edfb5.5e939","name":"","method":"use","ret":"txt","url":"","x":695.0994110107422,"y":239.09091186523438,"wires":[["4450040a.ae560c"]]},{"id":"4450040a.ae560c","type":"debug","z":"164edfb5.5e939","name":"","active":true,"console":"false","complete":"false","x":937.0994110107422,"y":236.09091186523438,"wires":[]},{"id":"b8eb6def.f7157","type":"inject","z":"164edfb5.5e939","name":"","topic":"Reset GeoTweets","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"x":133.0994415283203,"y":318.0909118652344,"wires":[["78de908d.c29d8"]]},{"id":"78de908d.c29d8","type":"function","z":"164edfb5.5e939","name":"Reset GeoTweets","func":"msg.method = 'GET';\nmsg.url = context.global.host + '/TwitterHashtagClusterer/resetGeoTweetHashtagIndexed';\n\nreturn msg;","outputs":"1","noerr":0,"x":406.0994110107422,"y":317.0909118652344,"wires":[["beaa452d.fe80b8"]]},{"id":"beaa452d.fe80b8","type":"http request","z":"164edfb5.5e939","name":"","method":"use","ret":"txt","url":"","x":693.0994110107422,"y":316.0909118652344,"wires":[["896d3bf1.48c228"]]},{"id":"896d3bf1.48c228","type":"debug","z":"164edfb5.5e939","name":"","active":true,"console":"false","complete":"false","x":942.0994110107422,"y":315.0909118652344,"wires":[]},{"id":"77595b02.9bc564","type":"debug","z":"6b10de81.8bb45","name":"","active":false,"console":"false","complete":"true","x":227.75,"y":149,"wires":[]},{"id":"caa1bca1.181a9","type":"twitter in","z":"6b10de81.8bb45","twitter":"","tags":"wildfire","user":"false","name":"Search by tag","topic":"tweets","x":121.74995422363281,"y":77,"wires":[["77595b02.9bc564","7b3793f8.fd331c"]]},{"id":"cdc394ee.7cf8f8","type":"http request","z":"6b10de81.8bb45","name":"","method":"use","ret":"obj","url":"","x":665.7499542236328,"y":77.00006103515625,"wires":[["40c765bc.9ffb4c","1568605c.4fcbc"]]},{"id":"565760c7.dc865","type":"debug","z":"6b10de81.8bb45","name":"","active":false,"console":"false","complete":"payload","x":1092.5002975463867,"y":77.50015068054199,"wires":[]},{"id":"fce4de7b.d7967","type":"http request","z":"6b10de81.8bb45","name":"","method":"use","ret":"txt","url":"","x":1091.7500762939453,"y":160.00005340576172,"wires":[["565760c7.dc865"]]},{"id":"40c765bc.9ffb4c","type":"function","z":"6b10de81.8bb45","name":"Create GeoTweet","func":"// stop here. no geo info.\nif (msg.payload.success) // default response\n  return null;\n\nmsg.method = 'POST';\nmsg.url = context.global.host + '/api/GeoTweets';\nmsg.payload = {\n    tweet: msg.payload\n};\n\nreturn msg;","outputs":1,"noerr":0,"x":874.7499389648438,"y":77.11111450195312,"wires":[["fce4de7b.d7967","565760c7.dc865"]]},{"id":"7b3793f8.fd331c","type":"function","z":"6b10de81.8bb45","name":"Toggle","func":"if (1) // use this to disable twitter scrape\nreturn msg;\nelse\nreturn null; // stop here","outputs":1,"noerr":0,"x":311.7499237060547,"y":77.18170166015625,"wires":[["2a379e03.7a5642"]]},{"id":"5f52043a.f83cac","type":"file","z":"6b10de81.8bb45","name":"orig tweets","filename":"/tmp/tweets","appendNewline":true,"createDir":false,"overwriteFile":"false","x":591.8505706787109,"y":148.1091079711914,"wires":[]},{"id":"ea483dac.b0f43","type":"change","z":"6b10de81.8bb45","name":"store orig tweet","rules":[{"t":"set","p":"payload","to":"msg.tweet"}],"action":"","property":"","from":"","to":"","reg":false,"x":412.85057067871094,"y":149.1091079711914,"wires":[["5f52043a.f83cac"]]},{"id":"2a379e03.7a5642","type":"function","z":"6b10de81.8bb45","name":"Convert Tweet","func":"msg.method = 'POST';\nmsg.url = context.global.host + '/TwitterHashtagClusterer/convertTweetToGeoTweet';\nmsg.payload = {\n    tweet: msg.tweet\n};\nreturn msg;\n//if (msg.location && msg.location.lat) {\n  //  node.warn('*** LOCATION FOUND ***')\n//    return msg;\n//} else {\n    //node.warn('tweet does not have geo (lat-lng) value');\n  //  return null; // stop flow\n//}","outputs":1,"noerr":0,"x":477.7499542236328,"y":77.18173217773438,"wires":[["cdc394ee.7cf8f8"]]},{"id":"1568605c.4fcbc","type":"debug","z":"6b10de81.8bb45","name":"","active":false,"console":"false","complete":"true","x":920.9838731553818,"y":181.57574378119568,"wires":[]}]